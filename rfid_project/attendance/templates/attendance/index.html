{% extends 'attendance/basic.html' %}

{% block title %}Anwesend{% endblock %}

{% block body %}

<div class="container-fluid text-center" >
  <br>
<h1 class="text-center" >Anwesend</h1>
  <br>
  <table class="table">
  <thead class="thead-light">
    <TR>
    <!-- <TH>ID.No</TH> -->
    <TH>Name</TH>
    <!-- <TH>RFID</TH> -->
    <!-- <TH>Phone Number</TH> -->
    <TH>Datum</TH>
    <TH>Anwesend seit</TH>
  <TH class="text-center" title="Löschen">Löschen</TH>
    <!-- <TH>Zeit Out</TH> -->
</TR>
  </thead>
    <tbody id="cards" class="cards">
    </tbody>
  </table>
</div>
{% endblock %}
{% block js %}
<script>
$(document).ready(function(){
    setInterval(function(){
      $.ajax({
        url: "{% url 'index1' %}"
        }).done(function(data) {
        $('#cards').html(data);
      });
    },3000);
  });
  
  function deleteEntry(cardId, btn){
    $.ajax({
      url: "{% url 'process' %}",
      data: { card_id: cardId, delete: 1 },
      method: 'GET'
    }).done(function(resp){
      // remove the table row containing the button
      $(btn).closest('tr').remove();
    }).fail(function(){
      alert('Löschen fehlgeschlagen');
    });
  }

  // delegated handler for delete buttons inside the dynamically loaded table
  $(document).on('click', '.delete-btn', function(e){
    var card = $(this).data('card');
    deleteEntry(card, this);
  });
  </script>
{% endblock %}
